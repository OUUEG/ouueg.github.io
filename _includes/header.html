<header class="site-header" role="banner">
  <div class="wrapper px-4 md:px-6 md:container mx-auto flex flex-col items-center gap-2 w-full">
    {%- assign default_paths = site.pages | map: "path" -%}
    {%- assign toplevel = site.pages | where: "dir", "/" | where_exp: "page", "page.path != 'feed.xml'" | where_exp: "page", "page.path != 'index.html'" -%}

    <!-- XL and up: full title, no wrap -->
    <a class="hidden xl:flex items-center gap-3" rel="author" href="{{ "/" | relative_url }}">
      <img class="inline" src="/assets/images/ouueg-button-padded.png" alt="OUUEG emblem" style="width:80px;height:auto;vertical-align:middle;">
      <span class="text-2xl font-semibold whitespace-nowrap">{{ site.title | escape }}</span>
    </a>

    <!-- MDâ€“LG: compact title centered (no hamburger here) -->
    <a class="hidden md:flex xl:hidden items-center gap-3" rel="author" href="{{ "/" | relative_url }}">
      <img class="inline" src="/assets/images/ouueg-button-padded.png" alt="OUUEG emblem" style="width:80px;height:auto;vertical-align:middle;">
      <span class="text-2xl font-semibold">OUUEG</span>
    </a>

    <!-- <MD: mobile top bar with hamburger -->
    <div class="w-full flex items-center justify-between md:hidden pt-2">
      <a class="flex items-center gap-3" rel="author" href="{{ "/" | relative_url }}">
        <img class="inline" src="/assets/images/ouueg-button-padded.png" alt="OUUEG emblem" style="width:56px;height:auto;vertical-align:middle;">
        <span class="text-xl font-semibold">OUUEG</span>
      </a>

      <!-- Hamburger + slide-over drawer -->
      <label class="relative z-40 cursor-pointer p-4 -mr-2 touch-manipulation" for="mobile-menu">
        <input class="peer hidden" type="checkbox" id="mobile-menu" aria-controls="mobile-drawer" aria-expanded="false" />
        <div
          class="relative z-50 block h-[1px] w-7 bg-black bg-transparent content-['']
                 before:absolute before:top-[-0.35rem] before:z-50 before:block before:h-full before:w-full before:bg-black before:transition-all before:duration-200 before:ease-out before:content-['']
                 after:absolute after:right-0 after:bottom-[-0.35rem] after:block after:h-full after:w-full after:bg-black after:transition-all after:duration-200 after:ease-out after:content-['']
                 peer-checked:bg-transparent before:peer-checked:top-0 before:peer-checked:w-full before:peer-checked:rotate-45 before:peer-checked:transform
                 after:peer-checked:bottom-0 after:peer-checked:w-full after:peer-checked:-rotate-45 after:peer-checked:transform">
        </div>

        <!-- Drawer -->
        <div id="mobile-drawer"
             class="fixed top-0 right-0 z-40 h-full w-full sm:w-[85%] translate-x-full overflow-y-auto overscroll-y-none transition duration-500 peer-checked:translate-x-0">
          <div class="float-right min-h-full w-full sm:w-[85%] bg-white px-6 pt-16 shadow-2xl">
            <h2 class="sr-only" id="mobile-navigation">Mobile navigation</h2>
            <menu>
              {%- for t in toplevel -%}
                {%- assign slug = t.path | remove: ".md" -%}
                {%- assign directory = slug | prepend: "/" | append: "/" -%}
                <li class="border-b border-gray-100">
                  <a href="{{ t.url | relative_url }}" class="block py-3 text-lg font-medium hover:bg-gray-100">
                    {{ slug }}
                  </a>
                </li>
                {%- assign nested = site.pages | where: "dir", directory -%}
                {%- if nested.size > 0 -%}
                  <menu class="pl-3 pb-2">
                    {%- for n in nested -%}
                      <a href="{{ n.url | relative_url }}" class="block py-2 hover:bg-gray-100">{{ n.title }}</a>
                    {%- endfor -%}
                  </menu>
                {%- endif -%}
              {%- endfor -%}
            </menu>
          </div>
        </div>
      </label>
    </div>

    <!-- Desktop / tablet nav centered under the title -->
    <nav class="site-nav relative w-full max-w-7xl">
      <div class="hidden md:flex justify-center items-center mx-auto max-w-7xl px-2 md:px-6 lg:px-8 space-y-0">
        <div class="inline-block px-3 py-2">
          <a href="{{ "/" | relative_url }}" class="hover:bg-gray-100 font-medium">home</a>
        </div>

        {%- for t in toplevel -%}
          {%- assign slug = t.path | remove: ".md" -%}
          {%- assign directory = slug | prepend: "/" | append: "/" -%}
          {%- assign nested = site.pages | where: "dir", directory -%}
          {%- if nested.size > 0 -%}
            <div class="group relative inline-block px-3 py-2">
              <a href="{{ t.url | relative_url }}" class="group-hover:bg-gray-100 font-medium" aria-expanded="false" aria-controls="{{ slug }}-dropdown">
                {{ slug }}
              </a>
              <div class="absolute left-1/2 -translate-x-1/2 mt-1 invisible bg-white shadow group-hover:visible my-menu">
                {%- for n in nested -%}
                  <a href="{{ n.url | relative_url }}" class="block hover:bg-gray-100 px-3 py-2 whitespace-nowrap">{{ n.title }}</a>
                {%- endfor -%}
              </div>
            </div>
          {%- else -%}
            <div class="inline-block px-3 py-2 mb-2">
              <a href="{{ t.url | relative_url }}" class="hover:bg-gray-100 font-medium">{{ slug }}</a>
            </div>
          {%- endif -%}
        {%- endfor -%}
      </div>
    </nav>
  </div>
</header>