<header class="site-header" role="banner">
  <div class="wrapper px-6 md:container mx-auto flex flex-col items-start gap-3">
    {%- assign default_paths = site.pages | map: "path" -%}
    {%- assign toplevel = site.pages
        | where: "dir", "/"
        | where_exp: "page", "page.path != 'feed.xml'"
        | where_exp: "page", "page.path != 'index.html'"
    -%}

    <!-- XL and up: logo + full title on ONE line, left-aligned -->
    <a class="hidden xl:inline-flex items-center gap-3 self-start" rel="author" href="{{ "/" | relative_url }}">
      <img class="inline" src="/assets/images/ouueg-button-padded.png" alt="OUUEG emblem" style="width:80px;height:auto;vertical-align:middle;">
      <span class="whitespace-nowrap">{{ site.title | escape }}</span>
    </a>

    <!-- Below XL: compact title -->
    <a class="xl:hidden inline-flex items-center gap-3 self-start" rel="author" href="{{ "/" | relative_url }}">
      <img class="inline" src="/assets/images/ouueg-button-padded.png" alt="OUUEG emblem" style="width:80px;height:auto;vertical-align:middle;">
      <span>OUUEG</span>
    </a>

    <nav class="site-nav relative w-full max-w-7xl">
      <!-- Mobile: hamburger + drawer (unchanged) -->
      <aside class="md:hidden w-full flex justify-end">
        <h2 class="sr-only" id="mobile-navigation">Mobile navigation</h2>
        <label class="flex items-center relative z-40 cursor-pointer px-3 py-6" for="mobile-menu">
          <input class="peer hidden" type="checkbox" id="mobile-menu" />
          <div
            class="relative z-50 block h-[1px] w-7 bg-black bg-transparent content-['']
                   before:absolute before:top-[-0.35rem] before:z-50 before:block before:h-full before:w-full before:bg-black before:transition-all before:duration-200 before:ease-out before:content-['']
                   after:absolute after:right-0 after:bottom-[-0.35rem] after:block after:h-full after:w-full after:bg-black after:transition-all after:duration-200 after:ease-out after:content-['']
                   peer-checked:bg-transparent before:peer-checked:top-0 before:peer-checked:w-full before:peer-checked:rotate-45 before:peer-checked:transform
                   after:peer-checked:bottom-0 after:peer-checked:w-full after:peer-checked:-rotate-45 after:peer-checked:transform">
          </div>

          <div class="fixed top-0 right-0 z-40 h-full w-full translate-x-full overflow-y-auto overscroll-y-none transition duration-500 peer-checked:translate-x-0">
            <div class="float-right min-h-full w-[85%] bg-white px-6 pt-12 shadow-2xl">
              <menu>
                {%- for t in toplevel -%}
                  {%- assign slug = t.path | remove: ".md" -%}
                  {%- assign directory = slug | prepend: "/" | append: "/" -%}
                  <li>
                    <a href="{{ t.url | relative_url }}" class="font-medium block hover:bg-gray-100 text-left">
                      {{ slug }}
                    </a>
                  </li>
                  {%- assign nested = site.pages | where: "dir", directory -%}
                  {%- if nested.size > 0 -%}
                    <menu>
                      {%- for n in nested -%}
                        <a href="{{ n.url | relative_url }}" class="block hover:bg-gray-100">{{ n.title }}</a>
                      {%- endfor -%}
                    </menu>
                  {%- endif -%}
                {%- endfor -%}
              </menu>
            </div>
          </div>
        </label>
      </aside>

      <!-- Desktop / tablet: centered nav UNDER the title -->
      <div class="trigger hidden md:flex justify-center items-center w-full mx-auto max-w-7xl px-2 md:px-6 lg:px-8 gap-8 pt-2">
        <div class="inline-block">
          <a href="{{ "/" | relative_url }}" class="hover:bg-gray-100 font-medium">home</a>
        </div>

        {%- for t in toplevel -%}
          {%- assign slug = t.path | remove: ".md" -%}
          {%- assign directory = slug | prepend: "/" | append: "/" -%}
          {%- assign nested = site.pages | where: "dir", directory -%}
          {%- if nested.size > 0 -%}
            <div class="group relative inline-block">
              <a href="{{ t.url | relative_url }}" class="group-hover:bg-gray-100 font-medium" aria-expanded="false" aria-controls="{{ slug }}-dropdown">
                {{ slug }}
              </a>
              <div class="absolute left-1/2 -translate-x-1/2 mt-1 invisible bg-white group-hover:visible my-menu">
                {%- for n in nested -%}
                  <a href="{{ n.url | relative_url }}" class="block hover:bg-gray-100 px-3 whitespace-nowrap">{{ n.title }}</a>
                {%- endfor -%}
              </div>
            </div>
          {%- else -%}
            <div class="inline-block">
              <a href="{{ t.url | relative_url }}" class="hover:bg-gray-100 font-medium">{{ slug }}</a>
            </div>
          {%- endif -%}
        {%- endfor -%}
      </div>
    </nav>
  </div>
</header>